{"ast":null,"code":"import { __assign } from \"tslib\";\nimport * as React from 'react';\nimport { getRTL, classNamesFunction } from '@fluentui/utilities';\nimport { FocusZone } from '../../FocusZone';\nimport { getDateRangeArray, getDayGrid, getBoundedDateRange, isRestrictedDate, DAYS_IN_WEEK, compareDates, DateRangeType } from '@fluentui/date-time-utilities';\nimport { usePrevious, useId } from '@fluentui/react-hooks';\nimport { CalendarMonthHeaderRow } from './CalendarMonthHeaderRow';\nimport { CalendarGridRow } from './CalendarGridRow';\nvar getClassNames = classNamesFunction();\n\nfunction useDayRefs() {\n  var daysRef = React.useRef({});\n\n  var getSetRefCallback = function (dayKey) {\n    return function (element) {\n      if (element === null) {\n        delete daysRef.current[dayKey];\n      } else {\n        daysRef.current[dayKey] = element;\n      }\n    };\n  };\n\n  return [daysRef, getSetRefCallback];\n}\n\nfunction useWeeks(props, onSelectDate, getSetRefCallback) {\n  /**\n   * Initial parsing of the given props to generate IDayInfo two dimensional array, which contains a representation\n   * of every day in the grid. Convenient for helping with conversions between day refs and Date objects in callbacks.\n   */\n  var weeks = React.useMemo(function () {\n    var _a;\n\n    var weeksGrid = getDayGrid(props);\n    var firstVisibleDay = weeksGrid[1][0].originalDate;\n    var lastVisibleDay = weeksGrid[weeksGrid.length - 1][6].originalDate;\n    var markedDays = ((_a = props.getMarkedDays) === null || _a === void 0 ? void 0 : _a.call(props, firstVisibleDay, lastVisibleDay)) || [];\n    /**\n     * Weeks is a 2D array. Weeks[0] contains the last week of the prior range,\n     * Weeks[weeks.length - 1] contains first week of next range. These are for transition states.\n     *\n     * Weeks[1... weeks.length - 2] contains the actual visible data\n     */\n\n    var returnValue = [];\n\n    for (var weekIndex = 0; weekIndex < weeksGrid.length; weekIndex++) {\n      var week = [];\n\n      var _loop_1 = function (dayIndex) {\n        var day = weeksGrid[weekIndex][dayIndex];\n\n        var dayInfo = __assign(__assign({\n          onSelected: function () {\n            return onSelectDate(day.originalDate);\n          },\n          setRef: getSetRefCallback(day.key)\n        }, day), {\n          isMarked: day.isMarked || (markedDays === null || markedDays === void 0 ? void 0 : markedDays.some(function (markedDay) {\n            return compareDates(day.originalDate, markedDay);\n          }))\n        });\n\n        week.push(dayInfo);\n      };\n\n      for (var dayIndex = 0; dayIndex < DAYS_IN_WEEK; dayIndex++) {\n        _loop_1(dayIndex);\n      }\n\n      returnValue.push(week);\n    }\n\n    return returnValue; // TODO: this is missing deps on getSetRefCallback and onSelectDate (and depending on the entire\n    // props object may not be a good idea due to likely frequent mutation). It would be easy to\n    // fix getSetRefCallback to not mutate every render, but onSelectDate is passed down from\n    // Calendar and trying to fix it requires a huge cascade of changes.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props]);\n  return weeks;\n}\n/**\n * Hook to determine whether to animate the CalendarDayGrid forwards or backwards\n * @returns true if the grid should animate backwards; false otherwise\n */\n\n\nfunction useAnimateBackwards(weeks) {\n  var previousNavigatedDate = usePrevious(weeks[0][0].originalDate);\n\n  if (!previousNavigatedDate || previousNavigatedDate.getTime() === weeks[0][0].originalDate.getTime()) {\n    return undefined;\n  } else if (previousNavigatedDate <= weeks[0][0].originalDate) {\n    return false;\n  } else {\n    return true;\n  }\n}\n\nfunction useWeekCornerStyles(props) {\n  /**\n   *\n   * Section for setting the rounded corner styles on individual day cells. Individual day cells need different\n   * corners to be rounded depending on which date range type and where the cell is located in the current grid.\n   * If we just round all of the corners, there isn't a good overlap and we get gaps between contiguous day boxes\n   * in Edge browser.\n   *\n   */\n  var getWeekCornerStyles = function (classNames, initialWeeks) {\n    var weekCornersStyled = {};\n    /* need to handle setting all of the corners on arbitrarily shaped blobs\n          __\n       __|A |\n      |B |C |__\n      |D |E |F |\n           in this case, A needs top left rounded, top right rounded\n      B needs top left rounded\n      C doesn't need any rounding\n      D needs bottom left rounded\n      E doesn't need any rounding\n      F needs top right rounding\n    */\n    // cut off the animation transition weeks\n\n    var weeks = initialWeeks.slice(1, initialWeeks.length - 1); // if there's an item above, lose both top corners. Item below, lose both bottom corners, etc.\n\n    weeks.forEach(function (week, weekIndex) {\n      week.forEach(function (day, dayIndex) {\n        var above = weeks[weekIndex - 1] && weeks[weekIndex - 1][dayIndex] && isInSameHoverRange(weeks[weekIndex - 1][dayIndex].originalDate, day.originalDate, weeks[weekIndex - 1][dayIndex].isSelected, day.isSelected);\n        var below = weeks[weekIndex + 1] && weeks[weekIndex + 1][dayIndex] && isInSameHoverRange(weeks[weekIndex + 1][dayIndex].originalDate, day.originalDate, weeks[weekIndex + 1][dayIndex].isSelected, day.isSelected);\n        var left = weeks[weekIndex][dayIndex - 1] && isInSameHoverRange(weeks[weekIndex][dayIndex - 1].originalDate, day.originalDate, weeks[weekIndex][dayIndex - 1].isSelected, day.isSelected);\n        var right = weeks[weekIndex][dayIndex + 1] && isInSameHoverRange(weeks[weekIndex][dayIndex + 1].originalDate, day.originalDate, weeks[weekIndex][dayIndex + 1].isSelected, day.isSelected);\n        var style = [];\n        style.push(calculateRoundedStyles(classNames, above, below, left, right));\n        style.push(calculateBorderStyles(classNames, above, below, left, right));\n        weekCornersStyled[weekIndex + '_' + dayIndex] = style.join(' ');\n      });\n    });\n    return weekCornersStyled;\n  };\n\n  var calculateRoundedStyles = function (classNames, above, below, left, right) {\n    var style = [];\n    var roundedTopLeft = !above && !left;\n    var roundedTopRight = !above && !right;\n    var roundedBottomLeft = !below && !left;\n    var roundedBottomRight = !below && !right;\n\n    if (roundedTopLeft) {\n      style.push(getRTL() ? classNames.topRightCornerDate : classNames.topLeftCornerDate);\n    }\n\n    if (roundedTopRight) {\n      style.push(getRTL() ? classNames.topLeftCornerDate : classNames.topRightCornerDate);\n    }\n\n    if (roundedBottomLeft) {\n      style.push(getRTL() ? classNames.bottomRightCornerDate : classNames.bottomLeftCornerDate);\n    }\n\n    if (roundedBottomRight) {\n      style.push(getRTL() ? classNames.bottomLeftCornerDate : classNames.bottomRightCornerDate);\n    }\n\n    return style.join(' ');\n  };\n\n  var calculateBorderStyles = function (classNames, above, below, left, right) {\n    var style = [];\n\n    if (!above) {\n      style.push(classNames.datesAbove);\n    }\n\n    if (!below) {\n      style.push(classNames.datesBelow);\n    }\n\n    if (!left) {\n      style.push(getRTL() ? classNames.datesRight : classNames.datesLeft);\n    }\n\n    if (!right) {\n      style.push(getRTL() ? classNames.datesLeft : classNames.datesRight);\n    }\n\n    return style.join(' ');\n  };\n\n  var isInSameHoverRange = function (date1, date2, date1Selected, date2Selected) {\n    var dateRangeType = props.dateRangeType,\n        firstDayOfWeek = props.firstDayOfWeek,\n        workWeekDays = props.workWeekDays; // The hover state looks weird with non-contiguous days in work week view. In work week, show week hover state\n\n    var dateRangeHoverType = dateRangeType === DateRangeType.WorkWeek ? DateRangeType.Week : dateRangeType; // we do not pass daysToSelectInDayView because we handle setting those styles dyanamically in onMouseOver\n\n    var dateRange = getDateRangeArray(date1, dateRangeHoverType, firstDayOfWeek, workWeekDays);\n\n    if (date1Selected !== date2Selected) {\n      // if one is selected and the other is not, they can't be in the same range\n      return false;\n    } else if (date1Selected && date2Selected) {\n      // if they're both selected at the same time they must be in the same range\n      return true;\n    } // otherwise, both must be unselected, so check the dateRange\n\n\n    return dateRange.filter(function (date) {\n      return date.getTime() === date2.getTime();\n    }).length > 0;\n  };\n\n  return [getWeekCornerStyles, calculateRoundedStyles];\n}\n\nexport var CalendarDayGridBase = function (props) {\n  var navigatedDayRef = React.useRef(null);\n  var activeDescendantId = useId();\n\n  var onSelectDate = function (selectedDate) {\n    var _a, _b;\n\n    var firstDayOfWeek = props.firstDayOfWeek,\n        minDate = props.minDate,\n        maxDate = props.maxDate,\n        workWeekDays = props.workWeekDays,\n        daysToSelectInDayView = props.daysToSelectInDayView,\n        restrictedDates = props.restrictedDates;\n    var restrictedDatesOptions = {\n      minDate: minDate,\n      maxDate: maxDate,\n      restrictedDates: restrictedDates\n    };\n    var dateRange = getDateRangeArray(selectedDate, dateRangeType, firstDayOfWeek, workWeekDays, daysToSelectInDayView);\n    dateRange = getBoundedDateRange(dateRange, minDate, maxDate);\n    dateRange = dateRange.filter(function (d) {\n      return !isRestrictedDate(d, restrictedDatesOptions);\n    });\n    (_a = props.onSelectDate) === null || _a === void 0 ? void 0 : _a.call(props, selectedDate, dateRange);\n    (_b = props.onNavigateDate) === null || _b === void 0 ? void 0 : _b.call(props, selectedDate, true);\n  };\n\n  var _a = useDayRefs(),\n      daysRef = _a[0],\n      getSetRefCallback = _a[1];\n\n  var weeks = useWeeks(props, onSelectDate, getSetRefCallback);\n  var animateBackwards = useAnimateBackwards(weeks);\n\n  var _b = useWeekCornerStyles(props),\n      getWeekCornerStyles = _b[0],\n      calculateRoundedStyles = _b[1];\n\n  React.useImperativeHandle(props.componentRef, function () {\n    return {\n      focus: function () {\n        var _a, _b;\n\n        (_b = (_a = navigatedDayRef.current) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.call(_a);\n      }\n    };\n  }, []);\n  /**\n   *\n   * Section for setting hover/pressed styles. Because we want arbitrary blobs of days to be selectable, to support\n   * highlighting every day in the month for month view, css :hover style isn't enough, so we need mouse callbacks\n   * to set classnames on all relevant child refs to apply the styling\n   *\n   */\n\n  var getDayInfosInRangeOfDay = function (dayToCompare) {\n    // The hover state looks weird with non-contiguous days in work week view. In work week, show week hover state\n    var dateRangeHoverType = getDateRangeTypeToUse(props.dateRangeType, props.workWeekDays); // gets all the dates for the given date range type that are in the same date range as the given day\n\n    var dateRange = getDateRangeArray(dayToCompare.originalDate, dateRangeHoverType, props.firstDayOfWeek, props.workWeekDays, props.daysToSelectInDayView).map(function (date) {\n      return date.getTime();\n    }); // gets all the day refs for the given dates\n\n    var dayInfosInRange = weeks.reduce(function (accumulatedValue, currentWeek) {\n      return accumulatedValue.concat(currentWeek.filter(function (weekDay) {\n        return dateRange.indexOf(weekDay.originalDate.getTime()) !== -1;\n      }));\n    }, []);\n    return dayInfosInRange;\n  };\n\n  var getRefsFromDayInfos = function (dayInfosInRange) {\n    var dayRefs = [];\n    dayRefs = dayInfosInRange.map(function (dayInfo) {\n      return daysRef.current[dayInfo.key];\n    });\n    return dayRefs;\n  };\n\n  var styles = props.styles,\n      theme = props.theme,\n      className = props.className,\n      dateRangeType = props.dateRangeType,\n      showWeekNumbers = props.showWeekNumbers,\n      labelledBy = props.labelledBy,\n      lightenDaysOutsideNavigatedMonth = props.lightenDaysOutsideNavigatedMonth,\n      animationDirection = props.animationDirection;\n  var classNames = getClassNames(styles, {\n    theme: theme,\n    className: className,\n    dateRangeType: dateRangeType,\n    showWeekNumbers: showWeekNumbers,\n    lightenDaysOutsideNavigatedMonth: lightenDaysOutsideNavigatedMonth === undefined ? true : lightenDaysOutsideNavigatedMonth,\n    animationDirection: animationDirection,\n    animateBackwards: animateBackwards\n  }); // When the month is highlighted get the corner dates so that styles can be added to them\n\n  var weekCorners = getWeekCornerStyles(classNames, weeks);\n  var partialWeekProps = {\n    weeks: weeks,\n    navigatedDayRef: navigatedDayRef,\n    calculateRoundedStyles: calculateRoundedStyles,\n    activeDescendantId: activeDescendantId,\n    classNames: classNames,\n    weekCorners: weekCorners,\n    getDayInfosInRangeOfDay: getDayInfosInRangeOfDay,\n    getRefsFromDayInfos: getRefsFromDayInfos\n  };\n  return React.createElement(FocusZone, {\n    className: classNames.wrapper,\n    preventDefaultWhenHandled: true\n  }, React.createElement(\"table\", {\n    className: classNames.table,\n    \"aria-multiselectable\": \"false\",\n    \"aria-labelledby\": labelledBy,\n    \"aria-activedescendant\": activeDescendantId,\n    role: \"grid\"\n  }, React.createElement(\"tbody\", null, React.createElement(CalendarMonthHeaderRow, __assign({}, props, {\n    classNames: classNames,\n    weeks: weeks\n  })), React.createElement(CalendarGridRow, __assign({}, props, partialWeekProps, {\n    week: weeks[0],\n    weekIndex: -1,\n    rowClassName: classNames.firstTransitionWeek,\n    ariaRole: \"presentation\",\n    ariaHidden: true\n  })), weeks.slice(1, weeks.length - 1).map(function (week, weekIndex) {\n    return React.createElement(CalendarGridRow, __assign({}, props, partialWeekProps, {\n      key: weekIndex,\n      week: week,\n      weekIndex: weekIndex,\n      rowClassName: classNames.weekRow\n    }));\n  }), React.createElement(CalendarGridRow, __assign({}, props, partialWeekProps, {\n    week: weeks[weeks.length - 1],\n    weekIndex: -2,\n    rowClassName: classNames.lastTransitionWeek,\n    ariaRole: \"presentation\",\n    ariaHidden: true\n  })))));\n};\nCalendarDayGridBase.displayName = 'CalendarDayGridBase';\n/**\n * When given work week, if the days are non-contiguous, the hover states look really weird. So for non-contiguous\n * work weeks, we'll just show week view instead.\n */\n\nfunction getDateRangeTypeToUse(dateRangeType, workWeekDays) {\n  if (workWeekDays && dateRangeType === DateRangeType.WorkWeek) {\n    var sortedWWDays = workWeekDays.slice().sort();\n    var isContiguous = true;\n\n    for (var i = 1; i < sortedWWDays.length; i++) {\n      if (sortedWWDays[i] !== sortedWWDays[i - 1] + 1) {\n        isContiguous = false;\n        break;\n      }\n    }\n\n    if (!isContiguous || workWeekDays.length === 0) {\n      return DateRangeType.Week;\n    }\n  }\n\n  return dateRangeType;\n}","map":{"version":3,"mappings":"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","names":["React","getRTL","classNamesFunction","FocusZone","getDateRangeArray","getDayGrid","getBoundedDateRange","isRestrictedDate","DAYS_IN_WEEK","compareDates","DateRangeType","usePrevious","useId","CalendarMonthHeaderRow","CalendarGridRow","getClassNames","useDayRefs","daysRef","useRef","getSetRefCallback","dayKey","element","current","useWeeks","props","onSelectDate","weeks","useMemo","weeksGrid","firstVisibleDay","originalDate","lastVisibleDay","length","markedDays","getMarkedDays","_a","returnValue","weekIndex","week","dayIndex","day","dayInfo","onSelected","setRef","key","isMarked","some","markedDay","push","useAnimateBackwards","previousNavigatedDate","getTime","undefined","useWeekCornerStyles","getWeekCornerStyles","classNames","initialWeeks","weekCornersStyled","slice","forEach","above","isInSameHoverRange","isSelected","below","left","right","style","calculateRoundedStyles","calculateBorderStyles","join","roundedTopLeft","roundedTopRight","roundedBottomLeft","roundedBottomRight","topRightCornerDate","topLeftCornerDate","bottomRightCornerDate","bottomLeftCornerDate","datesAbove","datesBelow","datesRight","datesLeft","date1","date2","date1Selected","date2Selected","firstDayOfWeek","workWeekDays","dateRangeHoverType","dateRangeType","WorkWeek","Week","dateRange","filter","date","CalendarDayGridBase","navigatedDayRef","activeDescendantId","selectedDate","minDate","maxDate","daysToSelectInDayView","restrictedDates","restrictedDatesOptions","d","onNavigateDate","_b","animateBackwards","useImperativeHandle","componentRef","focus","getDayInfosInRangeOfDay","dayToCompare","getDateRangeTypeToUse","map","dayInfosInRange","reduce","accumulatedValue","currentWeek","concat","weekDay","indexOf","getRefsFromDayInfos","dayRefs","theme","className","showWeekNumbers","labelledBy","lightenDaysOutsideNavigatedMonth","animationDirection","styles","weekCorners","partialWeekProps","wrapper","preventDefaultWhenHandled","table","role","__assign","rowClassName","firstTransitionWeek","ariaRole","ariaHidden","weekRow","lastTransitionWeek","displayName","sortedWWDays","sort","isContiguous","i"],"sources":["C:\\Users\\Admin\\Desktop\\bookstore\\frontend\\node_modules\\@fluentui\\react\\lib\\components\\src\\components\\CalendarDayGrid\\CalendarDayGrid.base.tsx"],"sourcesContent":["import * as React from 'react';\nimport { getRTL, classNamesFunction } from '@fluentui/utilities';\nimport { FocusZone } from '../../FocusZone';\nimport {\n  getDateRangeArray,\n  getDayGrid,\n  getBoundedDateRange,\n  isRestrictedDate,\n  DAYS_IN_WEEK,\n  compareDates,\n  DateRangeType,\n  DayOfWeek,\n} from '@fluentui/date-time-utilities';\nimport { usePrevious, useId } from '@fluentui/react-hooks';\nimport { CalendarMonthHeaderRow } from './CalendarMonthHeaderRow';\nimport { CalendarGridRow } from './CalendarGridRow';\nimport type { IDay } from '@fluentui/date-time-utilities';\nimport type {\n  ICalendarDayGridProps,\n  ICalendarDayGridStyleProps,\n  ICalendarDayGridStyles,\n} from './CalendarDayGrid.types';\nimport type { IProcessedStyleSet } from '@fluentui/style-utilities';\n\nconst getClassNames = classNamesFunction<ICalendarDayGridStyleProps, ICalendarDayGridStyles>();\n\nexport interface IWeekCorners {\n  [key: string]: string;\n}\n\nexport interface IDayInfo extends IDay {\n  onSelected: () => void;\n  setRef(element: HTMLElement | null): void;\n}\n\nfunction useDayRefs() {\n  const daysRef = React.useRef<Record<string, HTMLElement>>({});\n\n  const getSetRefCallback = (dayKey: string) => (element: HTMLElement | null) => {\n    if (element === null) {\n      delete daysRef.current[dayKey];\n    } else {\n      daysRef.current[dayKey] = element;\n    }\n  };\n\n  return [daysRef, getSetRefCallback] as const;\n}\n\nfunction useWeeks(\n  props: ICalendarDayGridProps,\n  onSelectDate: (date: Date) => void,\n  getSetRefCallback: (dayKey: string) => (element: HTMLElement | null) => void,\n): IDayInfo[][] {\n  /**\n   * Initial parsing of the given props to generate IDayInfo two dimensional array, which contains a representation\n   * of every day in the grid. Convenient for helping with conversions between day refs and Date objects in callbacks.\n   */\n  const weeks = React.useMemo((): IDayInfo[][] => {\n    const weeksGrid = getDayGrid(props);\n\n    const firstVisibleDay = weeksGrid[1][0].originalDate;\n    const lastVisibleDay = weeksGrid[weeksGrid.length - 1][6].originalDate;\n    const markedDays = props.getMarkedDays?.(firstVisibleDay, lastVisibleDay) || [];\n\n    /**\n     * Weeks is a 2D array. Weeks[0] contains the last week of the prior range,\n     * Weeks[weeks.length - 1] contains first week of next range. These are for transition states.\n     *\n     * Weeks[1... weeks.length - 2] contains the actual visible data\n     */\n    const returnValue: IDayInfo[][] = [];\n\n    for (let weekIndex = 0; weekIndex < weeksGrid.length; weekIndex++) {\n      const week: IDayInfo[] = [];\n      for (let dayIndex = 0; dayIndex < DAYS_IN_WEEK; dayIndex++) {\n        const day = weeksGrid[weekIndex][dayIndex];\n        const dayInfo: IDayInfo = {\n          onSelected: () => onSelectDate(day.originalDate),\n          setRef: getSetRefCallback(day.key),\n          ...day,\n          isMarked: day.isMarked || markedDays?.some(markedDay => compareDates(day.originalDate, markedDay)),\n        };\n\n        week.push(dayInfo);\n      }\n      returnValue.push(week);\n    }\n\n    return returnValue;\n    // TODO: this is missing deps on getSetRefCallback and onSelectDate (and depending on the entire\n    // props object may not be a good idea due to likely frequent mutation). It would be easy to\n    // fix getSetRefCallback to not mutate every render, but onSelectDate is passed down from\n    // Calendar and trying to fix it requires a huge cascade of changes.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props]);\n\n  return weeks;\n}\n\n/**\n * Hook to determine whether to animate the CalendarDayGrid forwards or backwards\n * @returns true if the grid should animate backwards; false otherwise\n */\nfunction useAnimateBackwards(weeks: IDayInfo[][]): boolean | undefined {\n  const previousNavigatedDate = usePrevious(weeks[0][0].originalDate);\n\n  if (!previousNavigatedDate || previousNavigatedDate.getTime() === weeks[0][0].originalDate.getTime()) {\n    return undefined;\n  } else if (previousNavigatedDate <= weeks[0][0].originalDate) {\n    return false;\n  } else {\n    return true;\n  }\n}\n\nfunction useWeekCornerStyles(props: ICalendarDayGridProps) {\n  /**\n   *\n   * Section for setting the rounded corner styles on individual day cells. Individual day cells need different\n   * corners to be rounded depending on which date range type and where the cell is located in the current grid.\n   * If we just round all of the corners, there isn't a good overlap and we get gaps between contiguous day boxes\n   * in Edge browser.\n   *\n   */\n  const getWeekCornerStyles = (\n    classNames: IProcessedStyleSet<ICalendarDayGridStyles>,\n    initialWeeks: IDayInfo[][],\n  ): IWeekCorners => {\n    const weekCornersStyled: { [key: string]: string } = {};\n    /* need to handle setting all of the corners on arbitrarily shaped blobs\n          __\n       __|A |\n      |B |C |__\n      |D |E |F |\n\n      in this case, A needs top left rounded, top right rounded\n      B needs top left rounded\n      C doesn't need any rounding\n      D needs bottom left rounded\n      E doesn't need any rounding\n      F needs top right rounding\n    */\n\n    // cut off the animation transition weeks\n    const weeks = initialWeeks.slice(1, initialWeeks.length - 1);\n\n    // if there's an item above, lose both top corners. Item below, lose both bottom corners, etc.\n    weeks.forEach((week: IDayInfo[], weekIndex: number) => {\n      week.forEach((day: IDayInfo, dayIndex: number) => {\n        const above =\n          weeks[weekIndex - 1] &&\n          weeks[weekIndex - 1][dayIndex] &&\n          isInSameHoverRange(\n            weeks[weekIndex - 1][dayIndex].originalDate,\n            day.originalDate,\n            weeks[weekIndex - 1][dayIndex].isSelected,\n            day.isSelected,\n          );\n        const below =\n          weeks[weekIndex + 1] &&\n          weeks[weekIndex + 1][dayIndex] &&\n          isInSameHoverRange(\n            weeks[weekIndex + 1][dayIndex].originalDate,\n            day.originalDate,\n            weeks[weekIndex + 1][dayIndex].isSelected,\n            day.isSelected,\n          );\n        const left =\n          weeks[weekIndex][dayIndex - 1] &&\n          isInSameHoverRange(\n            weeks[weekIndex][dayIndex - 1].originalDate,\n            day.originalDate,\n            weeks[weekIndex][dayIndex - 1].isSelected,\n            day.isSelected,\n          );\n        const right =\n          weeks[weekIndex][dayIndex + 1] &&\n          isInSameHoverRange(\n            weeks[weekIndex][dayIndex + 1].originalDate,\n            day.originalDate,\n            weeks[weekIndex][dayIndex + 1].isSelected,\n            day.isSelected,\n          );\n\n        const style = [];\n        style.push(calculateRoundedStyles(classNames, above, below, left, right));\n        style.push(calculateBorderStyles(classNames, above, below, left, right));\n\n        weekCornersStyled[weekIndex + '_' + dayIndex] = style.join(' ');\n      });\n    });\n\n    return weekCornersStyled;\n  };\n\n  const calculateRoundedStyles = (\n    classNames: IProcessedStyleSet<ICalendarDayGridStyles>,\n    above: boolean,\n    below: boolean,\n    left: boolean,\n    right: boolean,\n  ): string => {\n    const style = [];\n    const roundedTopLeft = !above && !left;\n    const roundedTopRight = !above && !right;\n    const roundedBottomLeft = !below && !left;\n    const roundedBottomRight = !below && !right;\n\n    if (roundedTopLeft) {\n      style.push(getRTL() ? classNames.topRightCornerDate : classNames.topLeftCornerDate);\n    }\n    if (roundedTopRight) {\n      style.push(getRTL() ? classNames.topLeftCornerDate : classNames.topRightCornerDate);\n    }\n    if (roundedBottomLeft) {\n      style.push(getRTL() ? classNames.bottomRightCornerDate : classNames.bottomLeftCornerDate);\n    }\n    if (roundedBottomRight) {\n      style.push(getRTL() ? classNames.bottomLeftCornerDate : classNames.bottomRightCornerDate);\n    }\n\n    return style.join(' ');\n  };\n\n  const calculateBorderStyles = (\n    classNames: IProcessedStyleSet<ICalendarDayGridStyles>,\n    above: boolean,\n    below: boolean,\n    left: boolean,\n    right: boolean,\n  ): string => {\n    const style = [];\n\n    if (!above) {\n      style.push(classNames.datesAbove);\n    }\n    if (!below) {\n      style.push(classNames.datesBelow);\n    }\n    if (!left) {\n      style.push(getRTL() ? classNames.datesRight : classNames.datesLeft);\n    }\n    if (!right) {\n      style.push(getRTL() ? classNames.datesLeft : classNames.datesRight);\n    }\n\n    return style.join(' ');\n  };\n\n  const isInSameHoverRange = (date1: Date, date2: Date, date1Selected: boolean, date2Selected: boolean): boolean => {\n    const { dateRangeType, firstDayOfWeek, workWeekDays } = props;\n\n    // The hover state looks weird with non-contiguous days in work week view. In work week, show week hover state\n    const dateRangeHoverType = dateRangeType === DateRangeType.WorkWeek ? DateRangeType.Week : dateRangeType;\n\n    // we do not pass daysToSelectInDayView because we handle setting those styles dyanamically in onMouseOver\n    const dateRange = getDateRangeArray(date1, dateRangeHoverType, firstDayOfWeek, workWeekDays);\n\n    if (date1Selected !== date2Selected) {\n      // if one is selected and the other is not, they can't be in the same range\n      return false;\n    } else if (date1Selected && date2Selected) {\n      // if they're both selected at the same time they must be in the same range\n      return true;\n    }\n\n    // otherwise, both must be unselected, so check the dateRange\n    return dateRange.filter((date: Date) => date.getTime() === date2.getTime()).length > 0;\n  };\n\n  return [getWeekCornerStyles, calculateRoundedStyles] as const;\n}\n\nexport const CalendarDayGridBase: React.FunctionComponent<ICalendarDayGridProps> = props => {\n  const navigatedDayRef = React.useRef<HTMLTableCellElement>(null) as React.MutableRefObject<HTMLTableCellElement>;\n\n  const activeDescendantId = useId();\n\n  const onSelectDate = (selectedDate: Date): void => {\n    const { firstDayOfWeek, minDate, maxDate, workWeekDays, daysToSelectInDayView, restrictedDates } = props;\n    const restrictedDatesOptions = { minDate, maxDate, restrictedDates };\n\n    let dateRange = getDateRangeArray(selectedDate, dateRangeType, firstDayOfWeek, workWeekDays, daysToSelectInDayView);\n    dateRange = getBoundedDateRange(dateRange, minDate, maxDate);\n\n    dateRange = dateRange.filter((d: Date) => {\n      return !isRestrictedDate(d, restrictedDatesOptions);\n    });\n\n    props.onSelectDate?.(selectedDate, dateRange);\n    props.onNavigateDate?.(selectedDate, true);\n  };\n\n  const [daysRef, getSetRefCallback] = useDayRefs();\n\n  const weeks = useWeeks(props, onSelectDate, getSetRefCallback);\n  const animateBackwards = useAnimateBackwards(weeks);\n  const [getWeekCornerStyles, calculateRoundedStyles] = useWeekCornerStyles(props);\n\n  React.useImperativeHandle(\n    props.componentRef,\n    () => ({\n      focus() {\n        navigatedDayRef.current?.focus?.();\n      },\n    }),\n    [],\n  );\n\n  /**\n   *\n   * Section for setting hover/pressed styles. Because we want arbitrary blobs of days to be selectable, to support\n   * highlighting every day in the month for month view, css :hover style isn't enough, so we need mouse callbacks\n   * to set classnames on all relevant child refs to apply the styling\n   *\n   */\n  const getDayInfosInRangeOfDay = (dayToCompare: IDayInfo): IDayInfo[] => {\n    // The hover state looks weird with non-contiguous days in work week view. In work week, show week hover state\n    const dateRangeHoverType = getDateRangeTypeToUse(props.dateRangeType, props.workWeekDays);\n\n    // gets all the dates for the given date range type that are in the same date range as the given day\n    const dateRange = getDateRangeArray(\n      dayToCompare.originalDate,\n      dateRangeHoverType,\n      props.firstDayOfWeek,\n      props.workWeekDays,\n      props.daysToSelectInDayView,\n    ).map((date: Date) => date.getTime());\n\n    // gets all the day refs for the given dates\n    const dayInfosInRange = weeks.reduce((accumulatedValue: IDayInfo[], currentWeek: IDayInfo[]) => {\n      return accumulatedValue.concat(\n        currentWeek.filter((weekDay: IDayInfo) => dateRange.indexOf(weekDay.originalDate.getTime()) !== -1),\n      );\n    }, []);\n\n    return dayInfosInRange;\n  };\n\n  const getRefsFromDayInfos = (dayInfosInRange: IDayInfo[]): (HTMLElement | null)[] => {\n    let dayRefs: (HTMLElement | null)[] = [];\n    dayRefs = dayInfosInRange.map((dayInfo: IDayInfo) => daysRef.current[dayInfo.key]);\n\n    return dayRefs;\n  };\n\n  const {\n    styles,\n    theme,\n    className,\n    dateRangeType,\n    showWeekNumbers,\n    labelledBy,\n    lightenDaysOutsideNavigatedMonth,\n    animationDirection,\n  } = props;\n\n  const classNames = getClassNames(styles, {\n    theme: theme!,\n    className: className,\n    dateRangeType: dateRangeType,\n    showWeekNumbers: showWeekNumbers,\n    lightenDaysOutsideNavigatedMonth:\n      lightenDaysOutsideNavigatedMonth === undefined ? true : lightenDaysOutsideNavigatedMonth,\n    animationDirection: animationDirection,\n    animateBackwards: animateBackwards,\n  });\n\n  // When the month is highlighted get the corner dates so that styles can be added to them\n  const weekCorners: IWeekCorners = getWeekCornerStyles(classNames, weeks!);\n  const partialWeekProps = {\n    weeks,\n    navigatedDayRef,\n    calculateRoundedStyles,\n    activeDescendantId,\n    classNames,\n    weekCorners,\n    getDayInfosInRangeOfDay,\n    getRefsFromDayInfos,\n  } as const;\n\n  return (\n    <FocusZone className={classNames.wrapper} preventDefaultWhenHandled={true}>\n      <table\n        className={classNames.table}\n        aria-multiselectable=\"false\"\n        aria-labelledby={labelledBy}\n        aria-activedescendant={activeDescendantId}\n        role=\"grid\"\n      >\n        <tbody>\n          <CalendarMonthHeaderRow {...props} classNames={classNames} weeks={weeks} />\n          <CalendarGridRow\n            {...props}\n            {...partialWeekProps}\n            week={weeks[0]}\n            weekIndex={-1}\n            rowClassName={classNames.firstTransitionWeek}\n            ariaRole=\"presentation\"\n            ariaHidden={true}\n          />\n          {weeks!.slice(1, weeks!.length - 1).map((week: IDayInfo[], weekIndex: number) => (\n            <CalendarGridRow\n              {...props}\n              {...partialWeekProps}\n              key={weekIndex}\n              week={week}\n              weekIndex={weekIndex}\n              rowClassName={classNames.weekRow}\n            />\n          ))}\n          <CalendarGridRow\n            {...props}\n            {...partialWeekProps}\n            week={weeks![weeks!.length - 1]}\n            weekIndex={-2}\n            rowClassName={classNames.lastTransitionWeek}\n            ariaRole=\"presentation\"\n            ariaHidden={true}\n          />\n        </tbody>\n      </table>\n    </FocusZone>\n  );\n};\nCalendarDayGridBase.displayName = 'CalendarDayGridBase';\n\n/**\n * When given work week, if the days are non-contiguous, the hover states look really weird. So for non-contiguous\n * work weeks, we'll just show week view instead.\n */\nfunction getDateRangeTypeToUse(dateRangeType: DateRangeType, workWeekDays: DayOfWeek[] | undefined): DateRangeType {\n  if (workWeekDays && dateRangeType === DateRangeType.WorkWeek) {\n    const sortedWWDays = workWeekDays.slice().sort();\n    let isContiguous = true;\n    for (let i = 1; i < sortedWWDays.length; i++) {\n      if (sortedWWDays[i] !== sortedWWDays[i - 1] + 1) {\n        isContiguous = false;\n        break;\n      }\n    }\n\n    if (!isContiguous || workWeekDays.length === 0) {\n      return DateRangeType.Week;\n    }\n  }\n\n  return dateRangeType;\n}\n"]},"metadata":{},"sourceType":"module"}